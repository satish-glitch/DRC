<apex:page renderAs="pdf" controller="DRC_NBC_GenerateSamplePiController" showHeader="false" sidebar="false" applyBodyTag="false" applyHtmlTag="false" standardStylesheets="false">
    <html>
        <head>
            <style>
                @page {
                size: A4;
                margin: 15mm;
                }
                
                body {
                font-family: Arial, sans-serif;
                font-size: 9pt;
                color: #000;
                line-height: 1.3;
                }
                .company-header-wrapper {
                position: relative;
                margin-bottom: 20px;
                height: 100px; /* Adjust height as needed */
                }
                
                .logo-left {
                position: absolute;
                left: 0;
                top: 0;
                }
                
                .company-logo {
                max-width: 120px;
                height: auto;
                }
                
                .company-header {
                text-align: center;
                margin: 0 auto;
                width: 100%;
                }
                
                .company-header h1 {
                font-size: 12pt;
                font-weight: bold;
                margin: 0 0 5px 0;
                color: #000;
                }
                
                .company-header p {
                margin: 2px 0;
                font-size: 8pt;
                color: #000;
                }
                
                .header-info {
                display: flex;
                flex-direction: row;
                justify-content: space-between;
                align-items: flex-start; /* aligns Order Confirmation to the top */
                position: relative;
                }
                
                .left-column {
                width: 50%;
                font-size: 8pt;
                }
                
                
                
                .right-column {
                text-align: right;
                }
                
                .invoice-title {
                font-size: 15pt;
                font-weight: bold;
                margin: 0;
                }
                
                .address-section {
                text-align: left;
                display: flex;
                justify-content: space-between;
                gap: 10px;
                margin-bottom: 15px;
                page-break-inside: avoid;
                }
                
                .address-block {
                flex: 1;
                padding: 10px;
                border: 1px solid #000;
                font-size: 8pt;
                min-height: 80px;
                box-sizing: border-box;
                }
                
                .address-block h3 {
                font-weight: bold;
                padding: 5px;
                margin: -10px -10px 8px -10px;
                text-align: center;
                font-size: 9pt;
                }
                
                .address-block p {
                margin: 3px 0;
                line-height: 1.5;
                }
                
                .order-left,
                .order-right {
                float: left;
                width: 48%;
                font-size: 8pt;
                line-height: 0.9;
                box-sizing: border-box;
                }
                
                .order-left p,
                .order-right p {
                display: flex;
                margin: 2px 0;
                line-height: 0.9;
                }
                
                .order-left p strong {
                width: 160px;
                flex-shrink: 0;
                display: inline-block;
                text-align: left;
                }
                
                
                .order-left p span{
                flex-grow: 1;
                display: inline-block;
                text-align: left;
                }
                .order-right {
                float: right;
                width: 48%;
                font-size: 8pt;
                line-height: 0.9;
                box-sizing: border-box;
                }
                
                .order-right p {
                display: flex;
                margin: 2px 0;
                line-height: 0.9;
                }
                
                .order-right p strong {
                flex-shrink: 0;
                display: inline-block;
                text-align: left;
                width: 180px; /* Fixed width for perfect alignment */
                }
                
                .order-right p span {
                flex: 1;
                display: inline-block;
                text-align: right;
                word-break: break-word;
                }
                .items-table {
                width: 100%;
                border-collapse: collapse;
                margin-bottom: 10px;
                font-size: 8pt;
                border: none; /* Remove table border */
                }
                
                .items-table th,
                .items-table td {
                border: none; /* Remove cell borders */
                padding: 4px 6px;
                }
                
                .items-table th {
                text-align: center;
                font-weight: bold;
                }
                
                .items-table td.right {
                text-align: right;
                }
                
                .items-table td.center {
                text-align: center;
                }
                
                .totals-table {
                width: 40%;
                float: right;
                border-collapse: collapse;
                font-size: 8pt;
                margin-top: 10px;
                border: none; /* removes outer table border */
                }
                
                .totals-table td {
                padding: 4px 8px;
                border: none; /* removes cell borders */
                }
                
                .totals-table td.label {
                font-weight: bold;
                text-align: left;
                }
                
                .totals-table td.value {
                text-align: right;
                }
                
                .totals-table tr.total-row td {
                font-weight: bold;
                }
                
                .items-table thead th {
                border-top: 1px solid #000;
                border-bottom: 1px solid #000;
                }
                
                /* Totals table: line below first row's value only */
                .totals-table tr:first-child td.value {
                border-bottom: 1px solid #000;
                }
                
                /* Totals table: line above and below total row */
                .totals-table tr.total-row td.value {
                border-top: 1px solid #000;
                border-bottom: 1px solid #000;
                font-weight: bold;
                }
                
                .terms-section {
                clear: both;
                margin-top: 20px;
                font-size: 7pt;
                page-break-inside: avoid;
                }
                
                .terms-section h3 {
                font-size: 9pt;
                margin: 10px 0 5px 0;
                font-weight: bold;
                }
                
                .terms-section p {
                margin: 3px 0;
                text-align: justify;
                }
            </style>
        </head>
        <body>
            <!-- Company Header Layout -->
            <div class="company-header-wrapper">
                <div class="logo-left">
                    <apex:image url="{!URLFOR($Resource.DRC_NBC_DR_Logo)}" styleClass="company-logo" />
                </div>
                <apex:outputText value="{!$Label.DRC_NBC_Domestic_CompanyAddressHTML}" escape="false"/>   
            </div>
            <div class="right-column">
                <h2 class="invoice-title">Order Confirmation</h2>
            </div>                
            <!-- Header Info Section (Bill To, Order Title, Ship To) -->
            <div class="header-info">
                <div class="left-column">
                    <h3>Bill To:</h3>
                    <p>{!customerName}</p>
                    <p>{!billingAddress}</p>
                    <p>{!billingCity} {!billingState} {!billingPostalCode}</p>
                    <p>{!billingCountry}</p>
                                        
                    <h3>Ship To:</h3>
                    <p>{!customerName}</p>
                    <p>{!shippingAddress}</p>
                    <p>{!shippingCity} {!shippingState} {!shippingPostalCode}</p>
                    <p>{!shippingCountry}</p>
                </div>
            </div>
            <div class="order-left">
                <p><strong>Bill-to Customer No.</strong><span>{!billToCustomer}</span></p>
                <p><strong>Document Date</strong>
                    <span>
                        <apex:outputText value="{0,date,dd-MM-yy}">
                            <apex:param value="{!orderDate}" />
                        </apex:outputText>
                    </span>
                </p>
                <p><strong>Expected Delivery Date</strong>
                    <span>
                        <apex:outputText value="{0,date,dd-MM-yy}">
                            <apex:param value="{!ExpectedDeliveryDate}" />
                        </apex:outputText>
                    </span>
                </p>
                <p><strong>Order No.</strong><span>SODOM/2526/{!importSequence}</span></p>
                <p><strong>Payment Terms</strong><span>{!paymentTerms}</span></p>
                <p><strong>Sampling Shipping Cost</strong><span>{!shipmentMethod}</span></p>
                <p><strong>Courier Number</strong><span>{!couriernumber}</span></p>
                <p><strong>Delivery Status</strong><span>{!deliveryStatus}</span></p>
            </div>    
            <div class="order-right">
                <p><strong>Phone No.</strong><span>{!phoneNumber}</span></p>
                <p><strong>Home Page:</strong><span>{!website}</span></p>
                <p><strong>E-Mail:</strong><span>{!email}</span></p>
                <p><strong>Bank</strong><span>{!Bank}</span></p>
                <p><strong>Account No.</strong><span>{!AccountNo}</span></p>
                <p><strong>SalesPerson</strong><span>{!salesPerson}</span></p>
                <p><strong>Customer GST Reg No</strong><span>27AALFT1174H1ZZ</span></p>
                <p><strong>Sample Name</strong><span>{!SampleName}</span></p>
                <p><strong>Sample Type</strong><span>{!sampleType}</span></p>
            </div>         
            <div style="clear: both;"></div>
            <!-- Items Table -->
            <table class="items-table">
                <thead>
                    <tr>
                        <th style="width: 5%;">No.</th>
                        <th style="width: 12%;">Item Reference No.</th>
                        <th style="width: 35%;">Description</th>
                        <th style="width: 12%;">HSN/SAC</th>
                        <th style="width: 8%;">Quantity</th>
                        <th style="width: 10%;">Unit of Measure</th>
                        <th style="width: 9%;">Unit Price</th>
                        <th style="width: 9%;">Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <apex:variable var="rowNum" value="{!1}" />
                    <apex:repeat value="{!items}" var="item">
                        <tr>
                            <td class="center">{!rowNum}</td>
                            <td>{!item.referenceNo}</td>
                            <td>{!item.Description}</td>
                            <td class="center">{!item.HSN_SAC}</td>
                            <td class="right">{!item.quantity}</td>
                            <td class="center">{!item.unit}</td>
                            <td class="right">{!item.unitPrice}</td>
                            <td class="right">{!item.amount}</td>
                        </tr>
                        <apex:variable var="rowNum" value="{!rowNum + 1}" />
                    </apex:repeat>
                </tbody>
            </table>               
            <!-- Totals Section -->
            <table class="totals-table">
                <!-- <tr>
<td class="label">Total INR</td>
<td class="value">{!totalWithoutTax}</td>
</tr>
<tr>
<td class="label">CGST Amount</td>
<td class="value">{!cgst}</td>
</tr>
<tr>
<td class="label">SGST Amount</td>
<td class="value">{!sgst}</td>
</tr>
<tr>
<td class="label">IGST Amount</td>
<td class="value">{!igst}</td>
</tr>
<tr>
<td class="label">Other Taxes Amt</td>
<td class="value">{!otherTaxes}</td>
</tr>
<tr>
<td class="label">Charges Amount</td>
<td class="value">{!charges}</td>
</tr>
<tr>
<td class="label">TCS Amount</td>
<td class="value">{!tcs}</td>
</tr>-->
                <tr class="total-row">
                    <td class="label">Total INR Incl. Tax</td>
                    <td class="value">{!totalWithTax}</td>
                </tr>
            </table>
            <!-- Terms and Conditions -->
            <div class="terms-section">
                <h3>General terms and condition:</h3>
                <p>1. Unless stated otherwise, all prices indicated are ex-works (Incoterms) basis.</p>
                <apex:outputText value="{!$Label.DRC_NBC_Domestic_TermCondition_1}" escape="false"/>
                <apex:outputText value="{!$Label.DRC_NBC_Domestic_TermCondition_2}" escape="false"/>                  
                <h3>General Provisions:</h3>
                <apex:outputText value="{!$Label.DRC_NBC_Domestic_GeneralProvision_Part1}" escape="false"/>
                <apex:outputText value="{!$Label.DRC_NBC_Domestic_GeneralProvision_Part2}" escape="false"/>
            </div>
        </body>
    </html>
</apex:page>